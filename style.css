/* ===== PALETA DE CORES PADRONIZADA ===== */
:root {
 /* Cores Base */
 --bg-primary: #000000;
 --bg-secondary: #111111;
 --bg-tertiary: #222222;
 --text-primary: #ffffff;
 --text-secondary: #cccccc;
 --text-accent: #0ff;

 /* Cores de Destaque */
 --accent-cyan: #0ff;
 --accent-yellow: #ff0;
 --accent-green: #0f0;
 --accent-red: #f00;
 --accent-blue: #00f;

 /* Cores de Estados */
 --success-bg: #0f0;
 --success-text: #000;
 --warning-bg: #ff0;
 --warning-text: #000;
 --error-bg: #f00;
 --error-text: #fff;

 /* Cores de Eventos */
 --access-bg: rgba(0, 255, 0, 0.1);
 --access-border: #0f0;
 --error-bg: rgba(255, 0, 0, 0.1);
 --error-border: #f00;
 --modsec-bg: rgba(0, 255, 255, 0.1);
 --modsec-border: #0ff;

 /* Bordas e Sombras */
 --border-primary: #333333;
 --border-radius: 8px;
 --border-radius-small: 4px;
 --shadow-glow: 0 0 8px;
}

body {
 background-color: var(--bg-primary);
 color: var(--text-primary);
 font-family: Arial, sans-serif;
 margin: 0 auto;
 padding: 10px;
 font-size: 12px;
 max-width: 1400px;
 min-height: 100vh;
 display: flex;
 flex-direction: column;
 overflow-x: hidden;
}

.correlation-container {
 margin-bottom: 20px;
 color: var(--text-primary);
 max-height: 50vh;
 overflow-y: auto;
 border: 1px solid var(--border-primary);
 border-radius: var(--border-radius);
 padding: 10px;
}

h1 {
 text-align: center;
 color: var(--text-primary);
 margin-bottom: 10px;
 font-size: 1.2em;
}

.container {
 display: flex;
 flex-wrap: wrap;
 gap: 10px;
 color: var(--text-primary);
}

.logs-container {
 display: flex;
 gap: 20px;
 flex-wrap: wrap;
 flex: 1;
 min-height: 0;
 overflow-y: auto;
}

.log-box {
 background-color: var(--bg-secondary);
 border: 1px solid var(--border-primary);
 border-radius: var(--border-radius);
 padding: 10px;
 height: auto;
 max-height: 60vh;
 overflow: hidden;
 flex: 1;
 min-width: 300px;
 position: relative;
 display: flex;
 flex-direction: column;
}

.log-header {
 overflow: hidden;
 margin-bottom: 10px;
 padding-bottom: 8px;
 border-bottom: 1px solid var(--border-primary);
 flex-shrink: 0;
}

.log-title {
 color: var(--accent-cyan);
 font-weight: bold;
 float: left;
 margin: 0;
}

.log-badge {
 background: var(--bg-tertiary);
 padding: 2px 6px;
 border-radius: var(--border-radius-small);
 float: right;
 font-size: 0.8em;
}

.log-content {
 flex: 1;
 overflow-y: auto;
 overflow-x: hidden;
 clear: both;
 min-height: 0;
}

pre {
 white-space: pre-wrap;
 word-wrap: break-word;
 margin: 0;
 font-size: 0.9em;
 line-height: 1.2;
}

table.correlation {
 width: 100%;
 border-collapse: collapse;
 margin-bottom: 10px;
}

table.correlation th,
table.correlation td {
 border: 1px solid #333;
 padding: 4px;
 vertical-align: top;
 font-family: monospace;
}

table.correlation th {
 background: #222;
 color: #fff;
 text-align: left;
}

.checkbox-container {
 text-align: center;
 margin-bottom: 10px;
 padding: 8px;
 background-color: var(--bg-tertiary);
 border-radius: var(--border-radius);
}

.checkbox-group {
 text-align: center;
}

.checkbox-item {
 display: inline-block;
 margin-right: 10px;
}

.checkbox-item label {
 cursor: pointer;
 color: var(--accent-cyan);
 font-size: 0.9em;
}

button {
 background-color: var(--accent-cyan);
 color: #000;
 border: 1px solid var(--accent-cyan);
 border-radius: 6px;
 padding: 6px 12px;
 cursor: pointer;
 transition: all 0.2s;
}

button:hover {
 background-color: #00cccc;
 transform: translateY(-1px);
}

.modsec-event {
 border: 1px solid var(--border-primary);
 border-radius: 6px;
 margin: 5px 0;
 padding: 8px;
 background: var(--bg-tertiary);
 transition: max-height 0.3s ease;
}

.modsec-event.collapsed {
 /* max-height removido para evitar cortar conteúdo do cabeçalho */
 overflow: hidden;
}

.modsec-event:not(.collapsed) {
 max-height: 9999px;
}

.modsec-id {
 color: var(--accent-yellow);
 font-weight: bold;
 margin-bottom: 2px;
 font-size: 0.9em;

}

.modsec-section {
 border: 1px solid var(--border-primary);
 border-radius: var(--border-radius-small);
 margin: 2px 0;
 background: rgba(0, 0, 0, 0.2);
}

.modsec-section.collapsed {
 max-height: 20px;
 overflow: hidden;
 transition: max-height 0.3s ease;
}

.modsec-section:not(.collapsed) {
 max-height: 2000px;
 transition: max-height 0.3s ease;
}

.modsec-section.collapsed .section-content {
 display: none;
}

.section-toggle {
 cursor: pointer;
 color: var(--accent-green);
 font-weight: bold;
 user-select: none;
 padding: 4px 8px;
}

.section-toggle::before {
 content: "▶ ";
 color: var(--accent-cyan);
 font-size: 0.8em;
}

.modsec-section:not(.collapsed) .section-toggle::before {
 content: "▼ ";
}

.section-content {
 padding: 6px;
 background: rgba(0, 0, 0, 0.3);
 border-radius: var(--border-radius-small);
 margin-top: 4px;
}

.section-content pre {
 margin: 0;
 font-size: 0.8em;
 line-height: 1.2;
}

.modsec-content {
 color: var(--text-secondary);

 font-size: 0.8em;
 line-height: 1.2;
 max-height: 400px; /* Aumentado de 100px para 400px para melhor leitura */
 overflow-y: auto;
 padding: 6px;
 background: rgba(0, 0, 0, 0.3);
 border-radius: var(--border-radius-small);
 margin-top: 4px;
}

.modsec-content::-webkit-scrollbar {
 width: 6px;
}

.modsec-content::-webkit-scrollbar-track {
 background: var(--bg-secondary);
 border-radius: 3px;
}

.modsec-content::-webkit-scrollbar-thumb {
 background: var(--border-primary);
 border-radius: 3px;
}

.cache-info {
 color: var(--accent-green);
 font-size: 0.8em;
 text-align: right;
 margin-top: 5px;
 padding: 4px 8px;
 background: rgba(0, 255, 0, 0.1);
 border-radius: var(--border-radius-small);
 display: inline-block;
 float: right;
}

.filtro-container {
 background-color: var(--bg-tertiary);
 padding: 12px;
 margin-bottom: 10px;
 text-align: center;
 border-radius: var(--border-radius);
}

.filtro-input {
 padding: 6px 10px;
 border: 1px solid var(--border-primary);
 border-radius: 6px;
 background: var(--bg-primary);
 color: var(--text-primary);
 width: 150px;
 margin-right: 5px;
 transition: border-color 0.2s;
}

.filtro-input:focus {
 outline: none;
 border-color: var(--accent-cyan);
}

.filtro-status {
 margin-top: 8px;
 padding: 8px 12px;
 font-weight: bold;
 border-radius: 6px;
}

.status-success {
 background-color: var(--success-bg);
 color: var(--success-text);
 border: 1px solid var(--accent-green);
}

.status-warning {
 background-color: var(--warning-bg);
 color: var(--warning-text);
 border: 1px solid var(--accent-yellow);
}

.status-error {
 background-color: var(--error-bg);
 color: var(--error-text);
 border: 1px solid var(--accent-red);
}

.ip-highlight {
 background-color: var(--accent-yellow);
 color: #000;
 padding: 2px 4px;
 border-radius: 3px;
 font-weight: bold;
}

.log-content::-webkit-scrollbar {
 width: 8px;
}

.log-content::-webkit-scrollbar-track {
 background: var(--bg-secondary);
 border-radius: var(--border-radius-small);
}

.log-content::-webkit-scrollbar-thumb {
 background: var(--border-primary);
 border-radius: var(--border-radius-small);
}

.log-content::-webkit-scrollbar-thumb:hover {
 background: #444;
}

@media (max-width: 600px) {
 .log-box {
 width: 98%;
 height: 300px;
 }
}

.modsec-event.collapsed .modsec-content {
 display: none;
}

.modsec-toggle {
 cursor: pointer;
 color: var(--accent-yellow);
 font-weight: bold;
 user-select: none;
}

.modsec-toggle::before {
 content: "+ ";
 color: var(--accent-cyan);
}

.modsec-event:not(.collapsed) .modsec-toggle::before {
 content: "- ";
}

.timeline {
 position: relative;
 padding-left: 30px;
 display: flex;
 flex-direction: column;
 gap: 20px;
}

.timeline::before {
 content: '';
 position: absolute;
 left: 15px;
 top: 0;
 bottom: 0;
 width: 2px;
 background: var(--border-primary);
 border-radius: 1px;
}

.timeline-group {
 position: relative;
 padding-left: 20px;
 display: flex;
 flex-direction: column;
 gap: 10px;
}

.timeline-group::before {
 content: '';
 position: absolute;
 left: -25px;
 top: 10px;
 width: 10px;
 height: 10px;
 border-radius: 50%;
 background: var(--accent-cyan);
 box-shadow: var(--shadow-glow) var(--accent-cyan);
}

.timeline-group::after {
 content: '';
 position: absolute;
 left: -20px;
 top: 15px;
 width: 20px;
 height: 2px;
 background: var(--border-primary);
 border-radius: 0 10px 10px 0;
}

.timeline-time {
 font-weight: bold;
 color: var(--accent-yellow);
 font-size: 0.9em;
 padding: 4px 8px;
 background: rgba(255, 255, 0, 0.1);
 border-radius: var(--border-radius-small);
 display: inline-block;
}

.timeline-events {
 display: flex;
 flex-direction: column;
 gap: 10px;
}

.timeline-event {
 padding: 12px;
 border-radius: var(--border-radius);
 border-left: 4px solid;
 flex: 1;
}

.timeline-event.access-event {
 background: var(--access-bg);
 border-left-color: var(--access-border);
}

.timeline-event.error-event {
 background: var(--error-bg);
 border-left-color: var(--error-border);
}

.timeline-event.modsec-event {
 background: var(--modsec-bg);
 border-left-color: var(--modsec-border);
}

.timeline-toggle {
 cursor: pointer;
 font-weight: bold;
 user-select: none;
 padding: 4px 0;
 margin-bottom: 8px;
 border-bottom: 1px solid var(--border-primary);
 display: flex;
 justify-content: space-between;
 align-items: center;
}

.timeline-toggle::before {
 content: "+ ";
 color: var(--accent-cyan);
 font-weight: bold;
}

.timeline-event:not(.collapsed) .timeline-toggle::before {
 content: "- ";
}

.timeline-event.access-event .timeline-toggle::before {
 content: "+ Access Log ";
}

.timeline-event.access-event:not(.collapsed) .timeline-toggle::before {
 content: "- Access Log ";
}

.timeline-event.error-event .timeline-toggle::before {
 content: "+ Error Log ";
}

.timeline-event.error-event:not(.collapsed) .timeline-toggle::before {
 content: "- Error Log ";
}

.timeline-event.modsec-event .timeline-toggle::before {
 content: "+ ModSec Log ";
}

.timeline-event.modsec-event:not(.collapsed) .timeline-toggle::before {
 content: "- ModSec Log ";
}

.timeline-event.collapsed .event-content {
 display: none;
}

.event-content {
 font-family: monospace;
 font-size: 0.85em;
 line-height: 1.4;
 max-height: 200px;
 overflow-y: auto;
}

.event-content::-webkit-scrollbar {
 width: 6px;
}

.event-content::-webkit-scrollbar-track {
 background: var(--bg-secondary);
 border-radius: 3px;
}

.event-content::-webkit-scrollbar-thumb {
 background: var(--border-primary);
 border-radius: 3px;
}